<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>Ø²Ù„Ø²Ù„Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø®ÛŒØ± Ø¯Ø± Ø¬Ù‡Ø§Ù†</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@latest/dist/font-face.css" rel="stylesheet">
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      font-family: 'Vazirmatn', sans-serif;
      background: linear-gradient(to right, #e0f7fa, #f8f9fa);
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 {
      color: #2196f3;
      margin-bottom: 20px;
      font-size: 24px;
    }
    button {
      background: linear-gradient(to right, #4fc3f7, #81d4fa);
      color: white;
      padding: 12px 20px;
      margin: 10px;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background: #29b6f6;
    }
    #earthquake-globe {
      margin-top: 20px;
      width: 100%;
      max-width: 1000px;
      height: 400px;
      margin: auto;
    }
    #earthquake-effect {
      margin-top: 20px;
      padding: 15px;
      font-size: 18px;
      background-color: #f1f1f1;
      border-radius: 10px;
      min-height: 50px;
    }
    table {
      margin: 30px auto;
      border-collapse: collapse;
      width: 90%;
      max-width: 800px;
      background: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
    }
    th {
      background: #4fc3f7;
      color: white;
    }
    @media (max-width: 768px) {
      h1 {
        font-size: 20px;
        margin-bottom: 15px;
      }
      button {
        padding: 10px 15px;
        font-size: 14px;
      }
      #earthquake-globe {
        height: 250px; /* Ú©Ø§Ù‡Ø´ Ø§Ø±ØªÙØ§Ø¹ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ */
      }
      table {
        font-size: 14px; /* ØªØºÛŒÛŒØ± Ø§Ù†Ø¯Ø§Ø²Ù‡ ÙÙˆÙ†Øª Ø¬Ø¯ÙˆÙ„ */
      }
    }
    @media (max-width: 480px) {
      button {
        padding: 8px 12px;
        font-size: 12px;
      }
      #earthquake-globe {
        height: 200px; /* Ú©Ø§Ù‡Ø´ Ø¨ÛŒØ´ØªØ± Ø§Ø±ØªÙØ§Ø¹ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
      }
    }
  </style>
</head>
<body>

  <h1>Ø²Ù„Ø²Ù„Ù‡â€ŒÙ‡Ø§ÛŒ ÛŒÚ© Ù…Ø§Ù‡ Ø§Ø®ÛŒØ± Ø¯Ø± Ø³Ø±Ø§Ø³Ø± Ø¬Ù‡Ø§Ù†</h1>

  <div>
    <button onclick="loadEarthquakes()">Ù†Ù…Ø§ÛŒØ´ Ø²Ù„Ø²Ù„Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø®ÛŒØ± Ø¬Ù‡Ø§Ù†</button>
    <button onclick="simulateEarthquake(5)">5 Ø±ÛŒØ´ØªØ±</button>
    <button onclick="simulateEarthquake(6)">6 Ø±ÛŒØ´ØªØ±</button>
    <button onclick="simulateEarthquake(7)">7 Ø±ÛŒØ´ØªØ±</button>
    <button onclick="simulateEarthquake(8)">8 Ø±ÛŒØ´ØªØ±</button>
    <button onclick="simulateEarthquake(9)">9 Ø±ÛŒØ´ØªØ±</button>
    <button onclick="simulateEarthquake(10)">10 Ø±ÛŒØ´ØªØ±</button>
  </div>

  <div id="earthquake-globe">Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù†Ù‚Ø´Ù‡ØŒ Ø¯Ú©Ù…Ù‡ Ø±Ø§ ÙØ´Ø§Ø± Ø¯Ù‡ÛŒØ¯.</div>

  <div id="earthquake-effect">Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Øª Ø²Ù„Ø²Ù„Ù‡ Ø¨Ø±Ø§ÛŒ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ</div>

  <table id="earthquake-data">
    <thead>
      <tr>
        <th>Ø²Ù…Ø§Ù†</th>
        <th>Ù…ÙˆÙ‚Ø¹ÛŒØª</th>
        <th>Ø´Ø¯Øª</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>

  <script>
    function simulateEarthquake(magnitude) {
      let effectText = `Ø²Ù„Ø²Ù„Ù‡ Ø¨Ø§ Ø´Ø¯Øª ${magnitude} Ø±ÛŒØ´ØªØ±!`;
      
      let effectDiv = document.getElementById('earthquake-effect');
      effectDiv.innerHTML = effectText;
      effectDiv.style.backgroundColor = 'lightcoral';  // ØªØºÛŒÛŒØ± Ø±Ù†Ú¯ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡
    }

    async function fetchEarthquakeData() {
      try {
        const response = await fetch('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_hour.geojson');
        const data = await response.json();

        const iranEarthquakes = data.features.filter(item => item.properties.place.includes('Iran'));

        const tableBody = document.querySelector('#earthquake-data tbody');
        tableBody.innerHTML = ''; // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø¬Ø¯ÙˆÙ„ Ù‚Ø¨Ù„ÛŒ

        iranEarthquakes.forEach(earthquake => {
          const row = tableBody.insertRow();
          const timeCell = row.insertCell(0);
          const placeCell = row.insertCell(1);
          const magnitudeCell = row.insertCell(2);

          timeCell.textContent = new Date(earthquake.properties.time).toLocaleString('fa-IR');
          placeCell.textContent = earthquake.properties.place;
          magnitudeCell.textContent = earthquake.properties.mag;
        });
      } catch (error) {
        console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§:', error);
      }
    }

    function loadEarthquakes() {
      document.getElementById('earthquake-globe').innerHTML = "â³ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø²Ù„Ø²Ù„Ù‡â€ŒÙ‡Ø§...";

      fetch('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_month.geojson')
        .then(res => res.json())
        .then(data => {
          const features = data.features;

          if (features.length === 0) {
            document.getElementById('earthquake-globe').innerHTML = "âŒ Ù‡ÛŒÚ† Ø²Ù„Ø²Ù„Ù‡â€ŒØ§ÛŒ Ú¯Ø²Ø§Ø±Ø´ Ù†Ø´Ø¯Ù‡.";
            return;
          }

          const lats = features.map(f => f.geometry.coordinates[1]);
          const lons = features.map(f => f.geometry.coordinates[0]);
          const mags = features.map(f => f.properties.mag);
          const texts = features.map(f =>
            `ğŸ“ ${f.properties.place}<br>Ø´Ø¯Øª: ${f.properties.mag}<br>Ø²Ù…Ø§Ù†: ${new Date(f.properties.time).toLocaleString('fa-IR')}`
          );

          Plotly.newPlot('earthquake-globe', [{
            type: 'scattergeo',
            mode: 'markers',
            lat: lats,
            lon: lons,
            text: texts,
            hoverinfo: 'text',
            marker: {
              size: mags.map(m => m * 3),
              color: mags,
              colorscale: 'Reds',
              showscale: true
            }
          }], {
            geo: {
              projection: { type: 'equirectangular' },
              showland: true,
              landcolor: 'lightgreen',
              showocean: true,
              oceancolor: 'lightblue',
              coastlinecolor: 'gray',
              showcountries: true,
              countrycolor: 'gray',
              lonaxis: { range: [-180, 180] },
              lataxis: { range: [-90, 90] },
              center: { lon: 0, lat: 0 },
            },
            margin: { t: 0, b: 0, l: 0, r: 0 },
            title: {
              text: 'Ø²Ù„Ø²Ù„Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø®ÛŒØ± Ø¯Ø± Ø³Ø±Ø§Ø³Ø± Ø¬Ù‡Ø§Ù†',
              font: { size: 24 }
            }
          });
        })
        .catch(err => {
          document.getElementById('earthquake-globe').innerHTML = "â›” Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø²Ù„Ø²Ù„Ù‡.";
          console.error(err);
        });
    }

    // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¬Ø¯ÙˆÙ„ Ø²Ù„Ø²Ù„Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÛŒØ±Ø§Ù† Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØµÙØ­Ù‡
    document.addEventListener('DOMContentLoaded', fetchEarthquakeData);
  </script>
</body>
</html>
